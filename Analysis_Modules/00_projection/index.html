<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Selective Plane Projection for Z-Stacks - EpiTools Wiki Pages</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">EpiTools Wiki Pages</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../.." class="nav-link">Home</a>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Analysis Modules <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="./" class="dropdown-item active">Selective Plane Projection for Z-Stacks</a>
</li>
                                    
<li>
    <a href="../01_registration/" class="dropdown-item">Registration of Time Series</a>
</li>
                                    
<li>
    <a href="../02_clahe/" class="dropdown-item">Contrast limited adaptive histogram equalization</a>
</li>
                                    
<li>
    <a href="../03_segmentation/" class="dropdown-item">Region growing segmentation</a>
</li>
                                    
<li>
    <a href="../04_polygonMask/" class="dropdown-item">Polygonal Mask</a>
</li>
                                    
<li>
    <a href="../05_tracking/" class="dropdown-item">Tracking Corrections</a>
</li>
                                    
<li>
    <a href="../06_skeleton/" class="dropdown-item">Skeleton Generation</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Icy Plugins <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../Icy_Plugins/00_Installation/" class="dropdown-item">Installation of the EpiTools plugins for ICY</a>
</li>
                                    
<li>
    <a href="../../Icy_Plugins/01_CellOverlay/" class="dropdown-item">Generating overlays using CellOverlay</a>
</li>
                                    
<li>
    <a href="../../Icy_Plugins/02_CellGraph/" class="dropdown-item">Creating new Graphs with CellGraph</a>
</li>
                                    
<li>
    <a href="../../Icy_Plugins/03_CellExport/" class="dropdown-item">Exporting data with CellExport</a>
</li>
                                    
<li>
    <a href="../../Icy_Plugins/04_CellEditor/" class="dropdown-item">Modifying Skeleton Images with CellEditor</a>
</li>
                                    
<li>
    <a href="../../Icy_Plugins/05_CellSurface/" class="dropdown-item">Visualizing GridFit© Surfaces with CellSurface and CellProjection</a>
</li>
                                    
<li>
    <a href="../../Icy_Plugins/06_CellClone/" class="dropdown-item">Detecting Cell Clones</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Quick Guide <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../Quick_Guide/00_Installation/" class="dropdown-item">Installation</a>
</li>
                                    
<li>
    <a href="../../Quick_Guide/01_CreateAnalysisFile/" class="dropdown-item">01 CreateAnalysisFile</a>
</li>
                                    
<li>
    <a href="../../Quick_Guide/02_OpenAnalysisSM/" class="dropdown-item">02 OpenAnalysisSM</a>
</li>
                                    
<li>
    <a href="../../Quick_Guide/03_RunModules/" class="dropdown-item">03 RunModules</a>
</li>
                                    
<li>
    <a href="../../Quick_Guide/04_Connecting_icy/" class="dropdown-item">Visualize results in icy</a>
</li>
                                    
<li>
    <a href="../../Quick_Guide/05_Multiple_ROIs/" class="dropdown-item">Step-by-Step guide to export skeletons from multiple ROIs</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Support <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../Support/FAQ/" class="dropdown-item">Frequently Asked Questions</a>
</li>
                                    
<li>
    <a href="../../Support/Known_Issues/" class="dropdown-item">Known issues</a>
</li>
                                    
<li>
    <a href="../../Support/Latest_News/" class="dropdown-item">Support</a>
</li>
                                    
<li>
    <a href="../../Support/Release_Notes/" class="dropdown-item">Release note</a>
</li>
                                    
<li>
    <a href="../../Support/Software_License/" class="dropdown-item">Software License</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../.." class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../01_registration/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/epitools" class="nav-link"><i class="fa fa-github"></i> GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#selective-plane-projection-for-z-stacks" class="nav-link">Selective Plane Projection for Z-Stacks</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#summary" class="nav-link">Summary</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#assumptions" class="nav-link">Assumptions</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#main-algorithm-steps" class="nav-link">Main algorithm steps:</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#output-files-in-the-analysis-folder" class="nav-link">Output files in the Analysis/ folder</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#parameters" class="nav-link">Parameters</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#debugging" class="nav-link">Debugging</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#references" class="nav-link">References</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="selective-plane-projection-for-z-stacks">Selective Plane Projection for Z-Stacks</h1>
<hr />
<h2 id="summary">Summary</h2>
<p>Creates a 2D projection from a Z-stack by selectively choosing from which plane to extract each pixel based on a surface estimation.</p>
<p><img alt="Selective Plane Projection" src="../../Images/matlab/projection.png" /></p>
<hr />
<h2 id="assumptions">Assumptions</h2>
<p>The input image is composed of several z planes representing a cohesive tissue which can be approximated by a 3D surface. In order to exclude another surface from being also projected the latter has to have a lower intensity or at least a smaller number of high intensity points than the region of interest (ROI).</p>
<hr />
<h2 id="main-algorithm-steps">Main algorithm steps:</h2>
<ol>
<li>1st Surface estimation [1] using the highest intensities in the sample (1st quartile)</li>
<li>Application of a cutoff distance to confine the ROI</li>
<li>2nd Surface estimation [1] using the highest intensities in the confined ROI</li>
<li>Projection of the Z-Stack on a 2D plane using (3)</li>
</ol>
<hr />
<h2 id="output-files-in-the-analysis-folder">Output files in the <em>Analysis/</em> folder</h2>
<table>
<thead>
<tr>
<th>File</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ProjIm.mat</strong></td>
<td>Matlab matrix file containing the projected image for each frame</td>
</tr>
<tr>
<td><strong>Surface.mat</strong></td>
<td>Matlab matrix file containing the original z-plane index for each pixel in <em>ProjIm.mat</em></td>
</tr>
<tr>
<td><strong>vtk/gridfit_frame_###.vtk</strong></td>
<td>Surface files for every frame containing the coordinates of the 2nd gridFit estimation in ASCII format (1 grid point per line: x,y,z) (see <a href="../Icy_Plugins/05_CellSurface">CellSurface plugin</a> for further usage) [ ! <em>output added starting from version 2.1.5</em> ]</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="parameters">Parameters</h2>
<p><code>Parameter: Smoothing Radius</code></p>
<ul>
<li>Defines the amount of gaussian blur to be applied on the image before estimating the surface (the original image data is preserved for the modules to follow).</li>
<li>Selecting a higher amount of blurring will make the image smoother but mask the details.</li>
<li>units [pixels]</li>
<li>recommended range [0.1 - 5]</li>
</ul>
<p><code>Parameter: Surface Smoothness 1</code></p>
<ul>
<li>Input parameter for the first gridFit© estimation of the highest intensity surface.</li>
<li>Selecting a larger value will make the surface smoother but less accurate. The parameter should be tuned such that the surface is detailed enough to capture the ROI but without containing points from the outer region (e.g. visualized by spike-like departures). </li>
<li>units [positive scalar]  </li>
<li>recommended range [30 - 100]</li>
</ul>
<p><code>Parameter: Cutoff distance</code></p>
<ul>
<li>Defines the region of interest in absolute terms from the first estimated surface.</li>
<li>Selecting a larger cutoff distance will include more signal from above and below the estimated surface. It is important that the filtered set of high intensity points should include only signal from the ROI. </li>
<li>units [z-plane distance]  </li>
<li>recommended range [1-3, decimals allowed]</li>
</ul>
<p><code>Parameter: Surface Smoothness 2</code></p>
<ul>
<li>Input parameter for the 2nd gridFit© estimation of the intensity surface.</li>
<li>This surface estimation is based only on the points from the previous part (2) and can therefore be more detailed, i.e. less smooth. It is important to estimate the detailed morphology to ensure that the correct plane is extracted for every pixel location of the ROI.</li>
<li><em>units</em> [positive scalar]  </li>
<li><em>recommended range</em> [20-50]</li>
</ul>
<hr />
<h2 id="debugging">Debugging</h2>
<ul>
<li>Turn this switch on to see the intermediate estimated surfaces.</li>
<li><strong>Warning!</strong> Do only apply on single stacks generates a lot of images.</li>
</ul>
<hr />
<h2 id="references">References</h2>
<ul>
<li>[1] <a href="http://www.mathworks.ch/matlabcentral/fileexchange/8998-surface-fitting-using-gridfit">Surface Fitting using gridfit by John D’Errico</a></li>
</ul>
<hr />
<h6 id="do-you-think-these-informations-are-not-enough-to-help-you-drop-a-line-to-the-author-and-he-will-extend-this-tutorial-asap">Do you think these informations are not enough to help you? Drop a line to the author and he will extend this tutorial asap!</h6>
<h6 id="this-page-was-written-by-davide-heller-on-1011151740">This page was written by <a href="mailto:davide.heller@gmail.com">Davide Heller</a> on 10.11.15@17:40</h6>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-55332946-1', 'auto');
  ga('send', 'pageview');

</script></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../js/jquery-3.6.0.min.js"></script>
        <script src="../../js/bootstrap.min.js"></script>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js"></script>
        <script src="../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
